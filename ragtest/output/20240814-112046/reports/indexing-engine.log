11:20:46,159 graphrag.config.read_dotenv INFO Loading pipeline .env file
11:20:46,162 graphrag.index.cli INFO using default configuration: {
    "llm": {
        "api_key": "REDACTED, length 41",
        "type": "openai_chat",
        "model": "gpt-4o",
        "max_tokens": 14000,
        "temperature": 0.0,
        "top_p": 1.0,
        "n": 1,
        "request_timeout": 180.0,
        "api_base": "https://openai.api2d.net/v1/",
        "api_version": null,
        "proxy": null,
        "cognitive_services_endpoint": null,
        "deployment_name": null,
        "model_supports_json": true,
        "tokens_per_minute": 0,
        "requests_per_minute": 0,
        "max_retries": 10,
        "max_retry_wait": 10.0,
        "sleep_on_rate_limit_recommendation": true,
        "concurrent_requests": 25
    },
    "parallelization": {
        "stagger": 0.3,
        "num_threads": 50
    },
    "async_mode": "threaded",
    "root_dir": "./ragtest",
    "reporting": {
        "type": "file",
        "base_dir": "output/${timestamp}/reports",
        "storage_account_blob_url": null
    },
    "storage": {
        "type": "file",
        "base_dir": "output/${timestamp}/artifacts",
        "storage_account_blob_url": null
    },
    "cache": {
        "type": "file",
        "base_dir": "cache",
        "storage_account_blob_url": null
    },
    "input": {
        "type": "file",
        "file_type": "text",
        "base_dir": "input",
        "storage_account_blob_url": null,
        "encoding": "utf-8",
        "file_pattern": ".*\\.txt$",
        "file_filter": null,
        "source_column": null,
        "timestamp_column": null,
        "timestamp_format": null,
        "text_column": "text",
        "title_column": null,
        "document_attribute_columns": []
    },
    "embed_graph": {
        "enabled": false,
        "num_walks": 10,
        "walk_length": 40,
        "window_size": 2,
        "iterations": 3,
        "random_seed": 597832,
        "strategy": null
    },
    "embeddings": {
        "llm": {
            "api_key": "REDACTED, length 41",
            "type": "openai_embedding",
            "model": "text-embedding-3-small",
            "max_tokens": 4000,
            "temperature": 0,
            "top_p": 1,
            "n": 1,
            "request_timeout": 180.0,
            "api_base": "https://openai.api2d.net/v1/",
            "api_version": null,
            "proxy": null,
            "cognitive_services_endpoint": null,
            "deployment_name": null,
            "model_supports_json": null,
            "tokens_per_minute": 0,
            "requests_per_minute": 0,
            "max_retries": 10,
            "max_retry_wait": 10.0,
            "sleep_on_rate_limit_recommendation": true,
            "concurrent_requests": 25
        },
        "parallelization": {
            "stagger": 0.3,
            "num_threads": 50
        },
        "async_mode": "threaded",
        "batch_size": 16,
        "batch_max_tokens": 8191,
        "target": "required",
        "skip": [],
        "vector_store": null,
        "strategy": null
    },
    "chunks": {
        "size": 14000,
        "overlap": 1000,
        "group_by_columns": [
            "id"
        ],
        "strategy": null
    },
    "snapshots": {
        "graphml": false,
        "raw_entities": false,
        "top_level_nodes": false
    },
    "entity_extraction": {
        "llm": {
            "api_key": "REDACTED, length 41",
            "type": "openai_chat",
            "model": "gpt-4o",
            "max_tokens": 14000,
            "temperature": 0.0,
            "top_p": 1.0,
            "n": 1,
            "request_timeout": 180.0,
            "api_base": "https://openai.api2d.net/v1/",
            "api_version": null,
            "proxy": null,
            "cognitive_services_endpoint": null,
            "deployment_name": null,
            "model_supports_json": true,
            "tokens_per_minute": 0,
            "requests_per_minute": 0,
            "max_retries": 10,
            "max_retry_wait": 10.0,
            "sleep_on_rate_limit_recommendation": true,
            "concurrent_requests": 25
        },
        "parallelization": {
            "stagger": 0.3,
            "num_threads": 50
        },
        "async_mode": "threaded",
        "prompt": "prompts/entity_extraction.txt",
        "entity_types": [
            "organization",
            "person",
            "geo",
            "event"
        ],
        "max_gleanings": 1,
        "strategy": null
    },
    "summarize_descriptions": {
        "llm": {
            "api_key": "REDACTED, length 41",
            "type": "openai_chat",
            "model": "gpt-4o",
            "max_tokens": 14000,
            "temperature": 0.0,
            "top_p": 1.0,
            "n": 1,
            "request_timeout": 180.0,
            "api_base": "https://openai.api2d.net/v1/",
            "api_version": null,
            "proxy": null,
            "cognitive_services_endpoint": null,
            "deployment_name": null,
            "model_supports_json": true,
            "tokens_per_minute": 0,
            "requests_per_minute": 0,
            "max_retries": 10,
            "max_retry_wait": 10.0,
            "sleep_on_rate_limit_recommendation": true,
            "concurrent_requests": 25
        },
        "parallelization": {
            "stagger": 0.3,
            "num_threads": 50
        },
        "async_mode": "threaded",
        "prompt": "prompts/summarize_descriptions.txt",
        "max_length": 500,
        "strategy": null
    },
    "community_reports": {
        "llm": {
            "api_key": "REDACTED, length 41",
            "type": "openai_chat",
            "model": "gpt-4o",
            "max_tokens": 14000,
            "temperature": 0.0,
            "top_p": 1.0,
            "n": 1,
            "request_timeout": 180.0,
            "api_base": "https://openai.api2d.net/v1/",
            "api_version": null,
            "proxy": null,
            "cognitive_services_endpoint": null,
            "deployment_name": null,
            "model_supports_json": true,
            "tokens_per_minute": 0,
            "requests_per_minute": 0,
            "max_retries": 10,
            "max_retry_wait": 10.0,
            "sleep_on_rate_limit_recommendation": true,
            "concurrent_requests": 25
        },
        "parallelization": {
            "stagger": 0.3,
            "num_threads": 50
        },
        "async_mode": "threaded",
        "prompt": "prompts/community_report.txt",
        "max_length": 2000,
        "max_input_length": 8000,
        "strategy": null
    },
    "claim_extraction": {
        "llm": {
            "api_key": "REDACTED, length 41",
            "type": "openai_chat",
            "model": "gpt-4o",
            "max_tokens": 14000,
            "temperature": 0.0,
            "top_p": 1.0,
            "n": 1,
            "request_timeout": 180.0,
            "api_base": "https://openai.api2d.net/v1/",
            "api_version": null,
            "proxy": null,
            "cognitive_services_endpoint": null,
            "deployment_name": null,
            "model_supports_json": true,
            "tokens_per_minute": 0,
            "requests_per_minute": 0,
            "max_retries": 10,
            "max_retry_wait": 10.0,
            "sleep_on_rate_limit_recommendation": true,
            "concurrent_requests": 25
        },
        "parallelization": {
            "stagger": 0.3,
            "num_threads": 50
        },
        "async_mode": "threaded",
        "enabled": false,
        "prompt": "prompts/claim_extraction.txt",
        "description": "Any claims or facts that could be relevant to information discovery.",
        "max_gleanings": 1,
        "strategy": null
    },
    "cluster_graph": {
        "max_cluster_size": 10,
        "strategy": null
    },
    "umap": {
        "enabled": false
    },
    "local_search": {
        "text_unit_prop": 0.5,
        "community_prop": 0.1,
        "conversation_history_max_turns": 5,
        "top_k_entities": 10,
        "top_k_relationships": 10,
        "temperature": 0.0,
        "top_p": 1.0,
        "n": 1,
        "max_tokens": 12000,
        "llm_max_tokens": 2000
    },
    "global_search": {
        "temperature": 0.0,
        "top_p": 1.0,
        "n": 1,
        "max_tokens": 12000,
        "data_max_tokens": 12000,
        "map_max_tokens": 1000,
        "reduce_max_tokens": 2000,
        "concurrency": 32
    },
    "encoding_model": "cl100k_base",
    "skip_workflows": []
}
11:20:46,162 graphrag.index.create_pipeline_config INFO skipping workflows 
11:20:46,208 graphrag.index.run INFO Running pipeline
11:20:46,209 graphrag.index.storage.file_pipeline_storage INFO Creating file storage at ragtest/output/20240814-112046/artifacts
11:20:46,209 graphrag.index.input.load_input INFO loading input from root_dir=input
11:20:46,210 graphrag.index.input.load_input INFO using file storage for input
11:20:46,213 graphrag.index.storage.file_pipeline_storage INFO search ragtest/input for files matching .*\.txt$
11:20:46,213 graphrag.index.input.text INFO found text files from input, found [('book.txt', {})]
11:20:46,216 graphrag.index.input.text INFO Found 1 files, loading 1
11:20:46,220 graphrag.index.workflows.load INFO Workflow Run Order: ['create_base_text_units', 'create_base_extracted_entities', 'create_summarized_entities', 'create_base_entity_graph', 'create_final_entities', 'create_final_nodes', 'create_final_communities', 'join_text_units_to_entity_ids', 'create_final_relationships', 'join_text_units_to_relationship_ids', 'create_final_community_reports', 'create_final_text_units', 'create_base_documents', 'create_final_documents']
11:20:46,221 graphrag.index.run INFO Final # of rows loaded: 1
11:20:46,356 graphrag.index.run INFO Running workflow: create_base_text_units...
11:20:46,356 graphrag.index.run INFO dependencies for create_base_text_units: []
11:20:46,359 datashaper.workflow.workflow INFO executing verb orderby
11:20:46,361 datashaper.workflow.workflow INFO executing verb zip
11:20:46,363 datashaper.workflow.workflow INFO executing verb aggregate_override
11:20:46,367 datashaper.workflow.workflow INFO executing verb chunk
11:20:46,492 datashaper.workflow.workflow INFO executing verb select
11:20:46,495 datashaper.workflow.workflow INFO executing verb unroll
11:20:46,498 datashaper.workflow.workflow INFO executing verb rename
11:20:46,501 datashaper.workflow.workflow INFO executing verb genid
11:20:46,504 datashaper.workflow.workflow INFO executing verb unzip
11:20:46,507 datashaper.workflow.workflow INFO executing verb copy
11:20:46,510 datashaper.workflow.workflow INFO executing verb filter
11:20:46,517 graphrag.index.emit.parquet_table_emitter INFO emitting parquet table create_base_text_units.parquet
11:20:46,662 graphrag.index.run INFO Running workflow: create_base_extracted_entities...
11:20:46,662 graphrag.index.run INFO dependencies for create_base_extracted_entities: ['create_base_text_units']
11:20:46,663 graphrag.index.run INFO read table from storage: create_base_text_units.parquet
11:20:46,678 datashaper.workflow.workflow INFO executing verb entity_extract
11:20:46,680 graphrag.llm.openai.create_openai_client INFO Creating OpenAI client base_url=https://openai.api2d.net/v1
11:20:46,695 graphrag.index.llm.load_llm INFO create TPM/RPM limiter for gpt-4o: TPM=0, RPM=0
11:20:46,695 graphrag.index.llm.load_llm INFO create concurrency limiter for gpt-4o: 25
11:20:49,628 httpx INFO HTTP Request: POST https://openai.api2d.net/v1/chat/completions "HTTP/1.1 400 Bad Request"
11:20:49,635 graphrag.index.reporting.file_workflow_callbacks INFO Error Invoking LLM details={'input': '\n-Goal-\nGiven a text document that is potentially relevant to this activity, first identify all entities needed from the text in order to capture the information and ideas in the text.\nNext, report all relationships among the identified entities.\n\n-Steps-\n1. Identify all entities. For each identified entity, extract the following information:\n- entity_name: Name of the entity, capitalized\n- entity_type: Suggest several labels or categories for the entity. The categories should not be specific, but should be as general as possible.\n- entity_description: Comprehensive description of the entity\'s attributes and activities\nFormat each entity as ("entity"<|><entity_name><|><entity_type><|><entity_description>\n\n2. From the entities identified in step 1, identify all pairs of (source_entity, target_entity) that are *clearly related* to each other.\nFor each pair of related entities, extract the following information:\n- source_entity: name of the source entity, as identified in step 1\n- target_entity: name of the target entity, as identified in step 1\n- relationship_description: explanation as to why you think the source entity and the target entity are related to each other\n- relationship_strength: a numeric score indicating strength of the relationship between the source entity and target entity\n Format each relationship as ("relationship"<|><source_entity><|><target_entity><|><relationship_description><|><relationship_strength>)\n\n3. Return output in The primary language of the provided text is Chinese. as a single list of all the entities and relationships identified in steps 1 and 2. Use **##** as the list delimiter. If you have to translate, just translate the descriptions, nothing else!\n\n4. When finished, output <|COMPLETE|>\n\n-Examples-\n######################\n\nExample 1:\n\ntext:\n。通常于10～30 岁起病，发病高峰年龄为8～12岁，男性患病比例略高于女性。\n1. 日间过度思睡\n是发作性睡病的主要症状，表现为突然发生的不可抑制的思睡或睡眠发作，可出现于行走、进餐或交谈时，也可以发生在静息时。睡眠持续时间多为数分钟至数十分钟，每天可发生数次到数十次不等，多数患者经短时间的小睡后即可头脑清醒，但不能维持太长时间。\n2\n------------------------\noutput:\n("entity"<|>发作性睡病<|>MEDICAL CONDITION<|>发作性睡病是一种睡眠障碍，主要症状包括日间过度思睡，睡眠发作不可抑制，可能发生在各种活动中)##\n("entity"<|>日间过度思睡<|>SYMPTOM<|>日间过度思睡是发作性睡病的主要症状，表现为突然的不可抑制的思睡或睡眠发作，可能发生在多种日常活动中)##\n("relationship"<|>发作性睡病<|>日间过度思睡<|>日间过度思睡是发作性睡病的主要症状之一<|>10)<|COMPLETE|>\n#############################\n\n\nExample 2:\n\ntext:\n�清醒，发作后可回忆发作过程，且发作时无痫性放电。\n(4)其他疾病\n还需要与其他疾病鉴别，如睡眠不足综合征、周期性腿动、抑郁症、短暂性脑缺血发作、心理或精神疾病等相鉴别。\n（四）治疗\n1. 一般治疗\n发作性睡病患者应保持规律的、充足的夜间睡眠。白天应有计划地安排小睡特别是午睡来减少睡\n------------------------\noutput:\n("entity"<|>清醒<|>CONDITION, SYMPTOM<|>清醒是一种状态，发作后可以回忆发作过程，且发作时无痫性放电)\n##\n("entity"<|>睡眠不足综合征<|>DISEASE, CONDITION<|>睡眠不足综合征是一种睡眠障碍，表现为持续的睡眠不足)\n##\n("entity"<|>周期性腿动<|>DISEASE, CONDITION<|>周期性腿动是一种睡眠障碍，表现为夜间腿部不自主的抽动)\n##\n("entity"<|>抑郁症<|>DISEASE, CONDITION<|>抑郁症是一种常见的心理疾病，影响情绪和行为)\n##\n("entity"<|>短暂性脑缺血发作<|>DISEASE, CONDITION<|>短暂性脑缺血发作是一种脑血管疾病，可能导致短暂的神经功能障碍)\n##\n("entity"<|>心理或精神疾病<|>DISEASE, CONDITION<|>心理或精神疾病包括多种影响心理和情绪的疾病)\n##\n("relationship"<|>清醒<|>睡眠不足综合征<|>清醒状态可能与睡眠不足综合征有关，因为睡眠不足可能导致清醒状态的异常<|>7)\n##\n("relationship"<|>清醒<|>周期性腿动<|>清醒状态可能与周期性腿动有关，因为睡眠障碍可能影响清醒状态<|>6)\n##\n("relationship"<|>清醒<|>抑郁症<|>清醒状态可能与抑郁症有关，因为心理疾病可能影响清醒状态<|>6)\n##\n("relationship"<|>清醒<|>短暂性脑缺血发作<|>清醒状态可能与短暂性脑缺血发作有关，因为脑血管疾病可能影响清醒状态<|>7)\n##\n("relationship"<|>清醒<|>心理或精神疾病<|>清醒状态可能与心理或精神疾病有关，因为这些疾病可能影响清醒状态<|>6)\n<|COMPLETE|>\n#############################\n\n\n\n-Real Data-\n######################\ntext: 第十九章 睡眠障碍\n\n第三节 发作性睡病\n发作性睡病(narcolepsy)是一种原因不明的慢性睡眠障碍，本病的临床表现主要包括难以控制的日间思睡、猝倒发作、睡瘫、睡眠相关幻觉及夜间睡眠紊乱。国外人群患病率估计在0.02%~0.18%，中国人的患病率估计在0.04%左右。\n（一）病因与发病机制\n发作性睡病的病因不明，一般认为多基因易患性、自身免疫因素、感染等影响睡眠与觉醒相关神经环路的功能，导致发作性睡病的发生。下丘脑外侧区分泌素(hypocretin-1，Hcrt-1)神经元特异性丢失是本病的特征性病理改变。\n（二）临床表现\n发作性睡病的主要症状包括难以控制的日间思睡、猝倒发作、睡瘫、睡眠相关幻觉及夜间睡眠紊乱。通常于10～30 岁起病，发病高峰年龄为8～12岁，男性患病比例略高于女性。\n1. 日间过度思睡\n是发作性睡病的主要症状，表现为突然发生的不可抑制的思睡或睡眠发作，可出现于行走、进餐或交谈时，也可以发生在静息时。睡眠持续时间多为数分钟至数十分钟，每天可发生数次到数十次不等，多数患者经短时间的小睡后即可头脑清醒，但不能维持太长时间。\n2. 猝倒发作\n是发作性睡病的特征性表现，常见于强烈情感刺激如发怒、大笑时。猝倒可表现为患者跌倒或被迫坐下，或者低头、面部表情异常或张口等。发作时患者意识清楚，发作后可完全回忆。\n3. 睡眠瘫痪\n多在入睡或觉醒时出现，可持续数秒至数分钟，表现为肢体不能活动，不能言语，发作时意识清楚，患者常有濒死感，这种发作可被轻微刺激所终止。\n4. 睡眠相关幻觉\n多在入睡时发生，表现为在觉醒和睡眠转换期出现的幻觉，可以为视、触或听幻觉，也可表现为梦境样经历体验。\n5. 夜间睡眠紊乱\n患者常易醒、多梦，觉醒多发生在入睡后2～3小时，通常伴有再入睡困难。此外，患者夜间体动明显增多，可伴有周期性肢体运动或者REM睡眠行为异常。\n（三）诊断和鉴别诊断\n1. 诊断\n发作性睡病的诊断需结合临床表现、多导睡眠图及多次小睡试验结果、脑脊液下丘脑分泌素-1(Hcrt-1)水平。国际睡眠障碍分类第3版(International  Classification of Sleep Disorders, 3rd edition, ICSD-3)将发作性睡病分为两型：发作性睡病1型和发作性睡病2型。\n诊断标准如下：\n1.1 发作性睡病1型的诊断标准：须同时满足以下2条标准：\n(1)患者存在白天难以抑制的思睡，症状持续至少3个月以上。\n(2)满足以下1项或2项条件：①有猝倒发作(符合定义的基本特征)。经过标准的多次小睡潜伏期试验(multiple sleep latency test,MSLT)检查平均睡眠潜伏期≤8min,且出现≥2次 REM  睡眠始发(sleep onset rapid eye movement periods,SOREMPs)。 推荐MSLT 检查前进行夜间多导睡眠图 (nPSG)检查。 nPSG 出现SOREMP可以替代1次白天 MSLT  中的SOREMP。②免疫反应法检测脑脊液中 Hcrt-1 浓度≤110pg/ml 或<正常参考值 的1/3。\n1.2发作性睡病2型的诊断标准：须同时满足以下5条标准：\n(1)患者存在白天难以抑制的思睡或睡眠发作，症状持续至少3个月以上。\n(2)标准MSLT 检查平均睡眠潜伏期≤8分钟，且出现≥2次 SOREMPs, 推荐 MSLT 检查前进行nPSG 检查，nPSG出现睡眠始发REM睡眠现象可以替代1次白天 MSLT 中的睡眠始发REM睡眠现象。\n(3)无猝倒发作。\n(4)脑脊液中Hcrt-1 水平>110pg/ml或>正常参考值的1/3。\n(5) 思睡症状和（或）MSLT 结果无法用其他原因解释，如睡眠不足、OSA、睡眠时相延迟障碍、药物的使用或撤药等。\n2. 鉴别诊断\n(1)睡眠呼吸暂停低通气综合征（sleep apnea hypopnea syndrome, SAHS）\nSAHS主要临床表现包括夜间打鼾、呼吸暂停、憋醒、日间嗜睡和疲倦乏力等。明显伴有日间思睡的SAHS患者，白天小睡后一般不会感到短暂清醒，且不伴有猝倒发作。可通过多导睡眠图、多次小睡试验和脑脊液下丘脑分泌素的含量检测来鉴别。\n(2)特发性过度嗜睡\n特发性过度嗜睡主要临床表现为夜间睡眠时间过长，日间过度嗜睡，但不伴有猝倒发作。多导睡眠图可见夜间睡眠效率较高，睡眠时间长，多次小睡试验结果通常无SOREMPs。脑脊液下丘脑分泌素的水平在正常范围。\n(3)癫痫\n癫痫患者主要临床表现为反复发作的刻板的癫痫发作，癫痫发作时可伴意识丧失，典型发作时脑电图可见痫性放电。发作性猝倒患者发作时意识清醒，发作后可回忆发作过程，且发作时无痫性放电。\n(4)其他疾病\n还需要与其他疾病鉴别，如睡眠不足综合征、周期性腿动、抑郁症、短暂性脑缺血发作、心理或精神疾病等相鉴别。\n（四）治疗\n1. 一般治疗\n发作性睡病患者应保持规律的、充足的夜间睡眠。白天应有计划地安排小睡特别是午睡来减少睡意。在择业方面应避免选择驾驶、高空及水下作业。心理症状尤其是抑郁、自卑在发作性睡病患者中常见，应给予有效的心理干预。\n2、药物治疗\n药物治疗主要针对3类症状：日间嗜睡、猝倒和夜间睡眠障碍。\n（1）中枢兴奋剂  用于改善日间嗜睡症状。目前比较推荐的中枢兴奋剂包括替洛利生和莫达非尼。其他中枢兴奋剂包括哌甲酯、安非他明、匹莫林等。\n（2）抗抑郁剂  用于治疗猝倒症状。包括三环类抗抑郁剂如普罗替林、丙咪嗪、氯丙米嗪等，5-羟色胺再摄取抑制剂如氟西汀、帕罗西汀，以及5-羟色胺-去甲肾上腺素再摄取抑制剂如文拉法辛等。但应注意不能突然停药，避免猝倒持续状态。\n（3）镇静催眠药物 用于治疗夜间睡眠障碍，可使用唑吡坦、佐匹克隆、右佐匹克隆及苯二氮䓬类药物。\n（4） γ -羟丁酸钠 (gamma-hydroxybutyrate,GHB)   是一种传统的麻醉药，能够同时改善上述三种症状，药理机制尚不明确，长期应用可能出现药物依赖。\n######################\noutput:\n'}
11:20:49,636 root ERROR error extracting graph
Traceback (most recent call last):
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/index/graph/extractors/graph/graph_extractor.py", line 123, in __call__
    result = await self._process_document(text, prompt_variables)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/index/graph/extractors/graph/graph_extractor.py", line 151, in _process_document
    response = await self._llm(
               ^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/llm/openai/json_parsing_llm.py", line 34, in __call__
    result = await self._delegate(input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/llm/openai/openai_token_replacing_llm.py", line 37, in __call__
    return await self._delegate(input, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/llm/openai/openai_history_tracking_llm.py", line 33, in __call__
    output = await self._delegate(input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/llm/base/caching_llm.py", line 104, in __call__
    result = await self._delegate(input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/llm/base/rate_limiting_llm.py", line 177, in __call__
    result, start = await execute_with_retry()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/llm/base/rate_limiting_llm.py", line 159, in execute_with_retry
    async for attempt in retryer:
  File "/home/xiangchao/.local/lib/python3.12/site-packages/tenacity/asyncio/__init__.py", line 166, in __anext__
    do = await self.iter(retry_state=self._retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/tenacity/asyncio/__init__.py", line 153, in iter
    result = await action(retry_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/tenacity/_utils.py", line 99, in inner
    return call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/data2/zhangli/envs/graphrag/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/data2/zhangli/envs/graphrag/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/llm/base/rate_limiting_llm.py", line 165, in execute_with_retry
    return await do_attempt(), start
           ^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/llm/base/rate_limiting_llm.py", line 147, in do_attempt
    return await self._delegate(input, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/llm/base/base_llm.py", line 49, in __call__
    return await self._invoke(input, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/llm/base/base_llm.py", line 53, in _invoke
    output = await self._execute_llm(input, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/llm/openai/openai_chat_llm.py", line 55, in _execute_llm
    completion = await self.client.chat.completions.create(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/zhangli/envs/graphrag/lib/python3.12/site-packages/openai/resources/chat/completions.py", line 1305, in create
    return await self._post(
           ^^^^^^^^^^^^^^^^^
  File "/data2/zhangli/envs/graphrag/lib/python3.12/site-packages/openai/_base_client.py", line 1815, in post
    return await self.request(cast_to, opts, stream=stream, stream_cls=stream_cls)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data2/zhangli/envs/graphrag/lib/python3.12/site-packages/openai/_base_client.py", line 1509, in request
    return await self._request(
           ^^^^^^^^^^^^^^^^^^^^
  File "/data2/zhangli/envs/graphrag/lib/python3.12/site-packages/openai/_base_client.py", line 1610, in _request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'object': 'error', 'message': 'max_tokens is too large: 14000. This model supports at most 4096 completion tokens, whereas you provided 14000.', 'code': 50098, 'requestId': '88f045fdce0bf8de6045d8fdc4a765d0'}
11:20:49,641 graphrag.index.reporting.file_workflow_callbacks INFO Entity Extraction Error details={'doc_index': 0, 'text': '第十九章 睡眠障碍\n\n第三节 发作性睡病\n发作性睡病(narcolepsy)是一种原因不明的慢性睡眠障碍，本病的临床表现主要包括难以控制的日间思睡、猝倒发作、睡瘫、睡眠相关幻觉及夜间睡眠紊乱。国外人群患病率估计在0.02%~0.18%，中国人的患病率估计在0.04%左右。\n（一）病因与发病机制\n发作性睡病的病因不明，一般认为多基因易患性、自身免疫因素、感染等影响睡眠与觉醒相关神经环路的功能，导致发作性睡病的发生。下丘脑外侧区分泌素(hypocretin-1，Hcrt-1)神经元特异性丢失是本病的特征性病理改变。\n（二）临床表现\n发作性睡病的主要症状包括难以控制的日间思睡、猝倒发作、睡瘫、睡眠相关幻觉及夜间睡眠紊乱。通常于10～30 岁起病，发病高峰年龄为8～12岁，男性患病比例略高于女性。\n1. 日间过度思睡\n是发作性睡病的主要症状，表现为突然发生的不可抑制的思睡或睡眠发作，可出现于行走、进餐或交谈时，也可以发生在静息时。睡眠持续时间多为数分钟至数十分钟，每天可发生数次到数十次不等，多数患者经短时间的小睡后即可头脑清醒，但不能维持太长时间。\n2. 猝倒发作\n是发作性睡病的特征性表现，常见于强烈情感刺激如发怒、大笑时。猝倒可表现为患者跌倒或被迫坐下，或者低头、面部表情异常或张口等。发作时患者意识清楚，发作后可完全回忆。\n3. 睡眠瘫痪\n多在入睡或觉醒时出现，可持续数秒至数分钟，表现为肢体不能活动，不能言语，发作时意识清楚，患者常有濒死感，这种发作可被轻微刺激所终止。\n4. 睡眠相关幻觉\n多在入睡时发生，表现为在觉醒和睡眠转换期出现的幻觉，可以为视、触或听幻觉，也可表现为梦境样经历体验。\n5. 夜间睡眠紊乱\n患者常易醒、多梦，觉醒多发生在入睡后2～3小时，通常伴有再入睡困难。此外，患者夜间体动明显增多，可伴有周期性肢体运动或者REM睡眠行为异常。\n（三）诊断和鉴别诊断\n1. 诊断\n发作性睡病的诊断需结合临床表现、多导睡眠图及多次小睡试验结果、脑脊液下丘脑分泌素-1(Hcrt-1)水平。国际睡眠障碍分类第3版(International  Classification of Sleep Disorders, 3rd edition, ICSD-3)将发作性睡病分为两型：发作性睡病1型和发作性睡病2型。\n诊断标准如下：\n1.1 发作性睡病1型的诊断标准：须同时满足以下2条标准：\n(1)患者存在白天难以抑制的思睡，症状持续至少3个月以上。\n(2)满足以下1项或2项条件：①有猝倒发作(符合定义的基本特征)。经过标准的多次小睡潜伏期试验(multiple sleep latency test,MSLT)检查平均睡眠潜伏期≤8min,且出现≥2次 REM  睡眠始发(sleep onset rapid eye movement periods,SOREMPs)。 推荐MSLT 检查前进行夜间多导睡眠图 (nPSG)检查。 nPSG 出现SOREMP可以替代1次白天 MSLT  中的SOREMP。②免疫反应法检测脑脊液中 Hcrt-1 浓度≤110pg/ml 或<正常参考值 的1/3。\n1.2发作性睡病2型的诊断标准：须同时满足以下5条标准：\n(1)患者存在白天难以抑制的思睡或睡眠发作，症状持续至少3个月以上。\n(2)标准MSLT 检查平均睡眠潜伏期≤8分钟，且出现≥2次 SOREMPs, 推荐 MSLT 检查前进行nPSG 检查，nPSG出现睡眠始发REM睡眠现象可以替代1次白天 MSLT 中的睡眠始发REM睡眠现象。\n(3)无猝倒发作。\n(4)脑脊液中Hcrt-1 水平>110pg/ml或>正常参考值的1/3。\n(5) 思睡症状和（或）MSLT 结果无法用其他原因解释，如睡眠不足、OSA、睡眠时相延迟障碍、药物的使用或撤药等。\n2. 鉴别诊断\n(1)睡眠呼吸暂停低通气综合征（sleep apnea hypopnea syndrome, SAHS）\nSAHS主要临床表现包括夜间打鼾、呼吸暂停、憋醒、日间嗜睡和疲倦乏力等。明显伴有日间思睡的SAHS患者，白天小睡后一般不会感到短暂清醒，且不伴有猝倒发作。可通过多导睡眠图、多次小睡试验和脑脊液下丘脑分泌素的含量检测来鉴别。\n(2)特发性过度嗜睡\n特发性过度嗜睡主要临床表现为夜间睡眠时间过长，日间过度嗜睡，但不伴有猝倒发作。多导睡眠图可见夜间睡眠效率较高，睡眠时间长，多次小睡试验结果通常无SOREMPs。脑脊液下丘脑分泌素的水平在正常范围。\n(3)癫痫\n癫痫患者主要临床表现为反复发作的刻板的癫痫发作，癫痫发作时可伴意识丧失，典型发作时脑电图可见痫性放电。发作性猝倒患者发作时意识清醒，发作后可回忆发作过程，且发作时无痫性放电。\n(4)其他疾病\n还需要与其他疾病鉴别，如睡眠不足综合征、周期性腿动、抑郁症、短暂性脑缺血发作、心理或精神疾病等相鉴别。\n（四）治疗\n1. 一般治疗\n发作性睡病患者应保持规律的、充足的夜间睡眠。白天应有计划地安排小睡特别是午睡来减少睡意。在择业方面应避免选择驾驶、高空及水下作业。心理症状尤其是抑郁、自卑在发作性睡病患者中常见，应给予有效的心理干预。\n2、药物治疗\n药物治疗主要针对3类症状：日间嗜睡、猝倒和夜间睡眠障碍。\n（1）中枢兴奋剂  用于改善日间嗜睡症状。目前比较推荐的中枢兴奋剂包括替洛利生和莫达非尼。其他中枢兴奋剂包括哌甲酯、安非他明、匹莫林等。\n（2）抗抑郁剂  用于治疗猝倒症状。包括三环类抗抑郁剂如普罗替林、丙咪嗪、氯丙米嗪等，5-羟色胺再摄取抑制剂如氟西汀、帕罗西汀，以及5-羟色胺-去甲肾上腺素再摄取抑制剂如文拉法辛等。但应注意不能突然停药，避免猝倒持续状态。\n（3）镇静催眠药物 用于治疗夜间睡眠障碍，可使用唑吡坦、佐匹克隆、右佐匹克隆及苯二氮䓬类药物。\n（4） γ -羟丁酸钠 (gamma-hydroxybutyrate,GHB)   是一种传统的麻醉药，能够同时改善上述三种症状，药理机制尚不明确，长期应用可能出现药物依赖。'}
11:20:49,660 datashaper.workflow.workflow INFO executing verb merge_graphs
11:20:49,665 graphrag.index.emit.parquet_table_emitter INFO emitting parquet table create_base_extracted_entities.parquet
11:20:49,851 graphrag.index.run INFO Running workflow: create_summarized_entities...
11:20:49,851 graphrag.index.run INFO dependencies for create_summarized_entities: ['create_base_extracted_entities']
11:20:49,852 graphrag.index.run INFO read table from storage: create_base_extracted_entities.parquet
11:20:49,862 datashaper.workflow.workflow INFO executing verb summarize_descriptions
11:20:49,864 graphrag.index.emit.parquet_table_emitter INFO emitting parquet table create_summarized_entities.parquet
11:20:49,989 graphrag.index.run INFO Running workflow: create_base_entity_graph...
11:20:49,989 graphrag.index.run INFO dependencies for create_base_entity_graph: ['create_summarized_entities']
11:20:49,989 graphrag.index.run INFO read table from storage: create_summarized_entities.parquet
11:20:50,0 datashaper.workflow.workflow INFO executing verb cluster_graph
11:20:50,0 graphrag.index.verbs.graph.clustering.cluster_graph WARNING Graph has no nodes
11:20:50,2 datashaper.workflow.workflow ERROR Error executing verb "cluster_graph" in create_base_entity_graph: Columns must be same length as key
Traceback (most recent call last):
  File "/home/xiangchao/.local/lib/python3.12/site-packages/datashaper/workflow/workflow.py", line 410, in _execute_verb
    result = node.verb.func(**verb_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/index/verbs/graph/clustering/cluster_graph.py", line 102, in cluster_graph
    output_df[[level_to, to]] = pd.DataFrame(
    ~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/pandas/core/frame.py", line 4299, in __setitem__
    self._setitem_array(key, value)
  File "/home/xiangchao/.local/lib/python3.12/site-packages/pandas/core/frame.py", line 4341, in _setitem_array
    check_key_length(self.columns, key, value)
  File "/home/xiangchao/.local/lib/python3.12/site-packages/pandas/core/indexers/utils.py", line 390, in check_key_length
    raise ValueError("Columns must be same length as key")
ValueError: Columns must be same length as key
11:20:50,4 graphrag.index.reporting.file_workflow_callbacks INFO Error executing verb "cluster_graph" in create_base_entity_graph: Columns must be same length as key details=None
11:20:50,4 graphrag.index.run ERROR error running workflow create_base_entity_graph
Traceback (most recent call last):
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/index/run.py", line 323, in run_pipeline
    result = await workflow.run(context, callbacks)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/datashaper/workflow/workflow.py", line 369, in run
    timing = await self._execute_verb(node, context, callbacks)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/datashaper/workflow/workflow.py", line 410, in _execute_verb
    result = node.verb.func(**verb_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/graphrag/index/verbs/graph/clustering/cluster_graph.py", line 102, in cluster_graph
    output_df[[level_to, to]] = pd.DataFrame(
    ~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/home/xiangchao/.local/lib/python3.12/site-packages/pandas/core/frame.py", line 4299, in __setitem__
    self._setitem_array(key, value)
  File "/home/xiangchao/.local/lib/python3.12/site-packages/pandas/core/frame.py", line 4341, in _setitem_array
    check_key_length(self.columns, key, value)
  File "/home/xiangchao/.local/lib/python3.12/site-packages/pandas/core/indexers/utils.py", line 390, in check_key_length
    raise ValueError("Columns must be same length as key")
ValueError: Columns must be same length as key
11:20:50,5 graphrag.index.reporting.file_workflow_callbacks INFO Error running pipeline! details=None
